<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lifecycle | Dobux</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/dox/dobux.ico">
    <meta name="description" content="基于 React Context 和 React Hooks 的轻量级数据流管理方案">
    <meta name="theme-color" content="#61dafb">
    
    <link rel="preload" href="/dox/assets/css/0.styles.84d88cfe.css" as="style"><link rel="preload" href="/dox/assets/js/app.71e7d2bd.js" as="script"><link rel="preload" href="/dox/assets/js/2.6f24bad2.js" as="script"><link rel="preload" href="/dox/assets/js/20.487fd743.js" as="script"><link rel="prefetch" href="/dox/assets/js/10.bebda9f0.js"><link rel="prefetch" href="/dox/assets/js/11.a4d4845b.js"><link rel="prefetch" href="/dox/assets/js/12.76373a60.js"><link rel="prefetch" href="/dox/assets/js/13.6470b2c5.js"><link rel="prefetch" href="/dox/assets/js/14.0eb3479b.js"><link rel="prefetch" href="/dox/assets/js/15.782d6367.js"><link rel="prefetch" href="/dox/assets/js/16.c089d8ac.js"><link rel="prefetch" href="/dox/assets/js/17.e81d33b1.js"><link rel="prefetch" href="/dox/assets/js/18.7db40c24.js"><link rel="prefetch" href="/dox/assets/js/19.3fa9b2f3.js"><link rel="prefetch" href="/dox/assets/js/21.6a4f9d7d.js"><link rel="prefetch" href="/dox/assets/js/3.d2e94c95.js"><link rel="prefetch" href="/dox/assets/js/4.0f1fc6aa.js"><link rel="prefetch" href="/dox/assets/js/5.ccadf297.js"><link rel="prefetch" href="/dox/assets/js/6.2cc0afe6.js"><link rel="prefetch" href="/dox/assets/js/7.0d04ed10.js"><link rel="prefetch" href="/dox/assets/js/8.fd2bd0ae.js"><link rel="prefetch" href="/dox/assets/js/9.36954ae5.js">
    <link rel="stylesheet" href="/dox/assets/css/0.styles.84d88cfe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dox/" class="home-link router-link-active"><!----> <span class="site-name">Dobux</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dox/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/dox/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/dox/api/" class="nav-link">
  API
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dox/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/dox/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/dox/api/" class="nav-link">
  API
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="lifecycle"><a href="#lifecycle" class="header-anchor">#</a> Lifecycle</h1> <h2 id="usedidmount"><a href="#usedidmount" class="header-anchor">#</a> useDidMount</h2> <p>模拟 Class Component 的 <code>componentDidMount</code> 生命周期钩子，只在组件 <code>mount</code> 时执行的 hook</p> <h3 id="代码演示"><a href="#代码演示" class="header-anchor">#</a> 代码演示</h3> <h4 id="基本用法"><a href="#基本用法" class="header-anchor">#</a> 基本用法</h4> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useDidMount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Dox'</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useDidMount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    effects<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="api"><a href="#api" class="header-anchor">#</a> API</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">useDidMount</span><span class="token punctuation">(</span>fn<span class="token operator">:</span> EffectCallback<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="params"><a href="#params" class="header-anchor">#</a> Params</h3> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th></tr></thead> <tbody><tr><td>fn</td> <td>组件 <code>mount</code> 时执行的函数</td> <td>EffectCallback</td></tr></tbody></table> <h2 id="usedidupdate"><a href="#usedidupdate" class="header-anchor">#</a> useDidUpdate</h2> <p>模拟 Class Component 的 <code>componentDidUpdate</code> 生命周期钩子，只在依赖更新时执行的 hook</p> <h3 id="代码演示-2"><a href="#代码演示-2" class="header-anchor">#</a> 代码演示</h3> <h4 id="基本用法-2"><a href="#基本用法-2" class="header-anchor">#</a> 基本用法</h4> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useDidUpdate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Dox'</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> useState

  <span class="token function">useDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="api-2"><a href="#api-2" class="header-anchor">#</a> API</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">useDidUpdate</span><span class="token punctuation">(</span>fn<span class="token operator">:</span> EffectCallback<span class="token punctuation">,</span> deps<span class="token operator">?</span><span class="token operator">:</span> React<span class="token punctuation">.</span>DependencyList<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="params-2"><a href="#params-2" class="header-anchor">#</a> Params</h3> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>fn</td> <td>依赖更新时执行的函数</td> <td>React.EffectCallback</td> <td></td></tr> <tr><td>deps?</td> <td>依赖更新时执行的函数</td> <td>React.DependencyList</td> <td></td></tr></tbody></table> <h2 id="useunmount"><a href="#useunmount" class="header-anchor">#</a> useUnmount</h2> <p>模拟 Class Component 的 <code>componentWillUnmount</code> 生命周期钩子，只在组件 <code>unmount</code> 时执行的 hook</p> <h3 id="代码演示-3"><a href="#代码演示-3" class="header-anchor">#</a> 代码演示</h3> <h4 id="基本用法-3"><a href="#基本用法-3" class="header-anchor">#</a> 基本用法</h4> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useUnmount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Dox'</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>

  <span class="token function">useUnmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    fn<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="api-3"><a href="#api-3" class="header-anchor">#</a> API</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">useUnmount</span><span class="token punctuation">(</span><span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="params-3"><a href="#params-3" class="header-anchor">#</a> Params</h3> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th></tr></thead> <tbody><tr><td>fn</td> <td>组件 <code>unmount</code> 时执行的函数</td> <td>() =&gt; void</td></tr></tbody></table> <h2 id="useforceupdate"><a href="#useforceupdate" class="header-anchor">#</a> useForceUpdate</h2> <p>模拟 Class Component 的 <code>this.forceUpdate</code> 方法，强制对组件进行刷新</p> <h3 id="代码演示-4"><a href="#代码演示-4" class="header-anchor">#</a> 代码演示</h3> <h4 id="基本用法-4"><a href="#基本用法-4" class="header-anchor">#</a> 基本用法</h4> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useForceUpdate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'Dox'</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> forceUpdate <span class="token operator">=</span> <span class="token function">useForceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Time: </span><span class="token punctuation">{</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>update<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        update
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="api-4"><a href="#api-4" class="header-anchor">#</a> API</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">useForceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
</code></pre></div><h3 id="result"><a href="#result" class="header-anchor">#</a> Result</h3> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th></tr></thead> <tbody><tr><td>dispatch</td> <td>调用该函数强制刷新组件</td> <td>() =&gt; void</td></tr></tbody></table></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2020-11-2 5:22:09 ├F10: PM┤</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/dox/assets/js/app.71e7d2bd.js" defer></script><script src="/dox/assets/js/2.6f24bad2.js" defer></script><script src="/dox/assets/js/20.487fd743.js" defer></script>
  </body>
</html>
